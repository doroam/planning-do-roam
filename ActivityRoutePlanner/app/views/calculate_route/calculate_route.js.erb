<%   #sets the nearest markers
  res =  params[:geo_result]
  start_lat = 0.0
  start_lon = 0.0
  end_lat = 0.0
  end_lon = 0.0
  if res.nearest_start!=nil
    point = res.nearest_start
    start_lat = point.lat
    start_lon = point.lon
    type = "nearest_src"%>
    addMark("<%=point.label%>","<%=start_lat%>","<%=start_lon%>","<%=type%>");
  <%end
  if res.nearest_end!=nil
    point = res.nearest_end
    end_lat = point.lat
    end_lon = point.lon
    type = "nearest_target"
  %>
  addMark("<%=point.label%>","<%=end_lat%>","<%=end_lon%>","<%=type%>");
  <%end%>
loadRoute('<%=params[:file_name]%>');
<%
  error_msg = "The next paths could not be found.";
  res.errors.each do |error|
      error_msg += "\\n"+error+"."
  end
  if res.errors.length>0%>
    alert('<%=escape_javascript(error_msg)%>');
 <% end%>

